angular.module("comments",["ngRoute","ui.bootstrap"]).config(["$routeProvider","$locationProvider",function(t,n){t.when("/",{templateUrl:"comments/comments.view.html",controller:"commentsCtrl",controllerAs:"vm"}).when("/comments/:idComment",{templateUrl:"comments/commentViewing/commentView.view.html",controller:"commentsViewCtrl",controllerAs:"vm"}).when("/registration",{templateUrl:"/auth/registration/registration.view.html",controller:"registrationCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).otherwise({controller:"otherCtrl",template:"<div></div>"}),n.html5Mode(!0),n.hashPrefix("")}]),function(){function t(e,o){return{comments:function(){return e.get("/api/comments")},commentById:function(t){return e.get("/api/comments/"+t)},editCommentById:function(t,n){return e.post("/api/comments/edit/"+t,n,{headers:{Authorization:"Bearer "+o.returnToken()}})},deleteById:function(t){return e.delete("/api/comments/"+t,{headers:{Authorization:"Bearer "+o.returnToken()}})},newComment:function(t){return e.post("/api/comments/new",t,{headers:{Authorization:"Bearer "+o.returnToken()}})}}}t.$inject=["$http","authentication"],angular.module("comments").service("commentsData",t)}(),function(){function t(e,n){var o=function(t){e.localStorage["comments-token"]=t},r=function(){return e.localStorage["comments-token"]},i=function(){var t=r();return!!t&&JSON.parse(e.atob(t.split(".")[1])).validityDate>Date.now()/1e3};return{storeToken:o,returnToken:r,registration:function(t){return n.post("/api/registration",t).then(function(t){o(t.data.token)})},login:function(t){return n.post("/api/login",t).then(function(t){o(t.data.token)})},logout:function(){e.localStorage.removeItem("comments-token")},logedin:i,currUser:function(){if(i()){var t=r(),n=JSON.parse(e.atob(t.split(".")[1]));return{mail:n.mail,name:n.name}}}}}t.$inject=["$window","$http"],angular.module("comments").service("authentication",t)}(),function(){function t(n,t){var e=this;e.loginData={mail:"",pass:""},e.firstToDisplay=n.search().page||"/",e.sendContent=function(){if(e.error="",!e.loginData.mail||!e.loginData.pass)return!(e.error="All data required.");e.login()},e.login=function(){e.error="",console.log(e.loginData),t.login(e.loginData).then(function(t){n.search("page",null),n.path(e.firstToDisplay)},function(t){e.error=t.data})}}t.$inject=["$location","authentication"],angular.module("comments").controller("loginCtrl",t)}(),function(){function t(n,t){var e=this;e.registerData={name:"",mail:"",pass:""},e.firstToDisplay=n.search().page||"/",e.sendContent=function(){if(e.error="",!(e.registerData.name&&e.registerData.mail&&e.registerData.pass))return!(e.error="Enter all the data!");e.register()},e.register=function(){e.error="",t.registration(e.registerData).then(function(t){n.search("login",null),n.path(e.firstToDisplay)},function(t){e.error=t.data})}}t.$inject=["$location","authentication"],angular.module("comments").controller("registrationCtrl",t)}(),function(){function t(t,n,e,o){var r=this;r.title="Comments",r.msg="Searching comments...",r.logedin=o.logedin(),t.comments().then(function(t){r.msg=0<t.data.length?"":"No comments.",r.data={comments:t.data}},function(t){r.msg="Error while fetching comments.",console.log(t.e)}),r.newComment=function(){r.newcomment.pic="",t.newComment(r.newcomment).then(function(t){r.msg=0<t.data.length?"":"No comments.",r.data.comments.push(t.data),r.newcomment.name="",r.newcomment.comment="",console.log(r.data)},function(t){r.msg="Error while fetching comments.",console.log(t.e)})},e.redirectTo=function(t){n.url("/comments/"+t._id)}}t.$inject=["commentsData","$location","$scope","authentication"],angular.module("comments").controller("commentsCtrl",t)}(),function(){function t(t){t.path("/")}t.$inject=["$location"],angular.module("comments").controller("otherCtrl",t)}(),function(){function t(t,n,e,o){var r=this;r.idComment=t.idComment,r.logedin=o.logedin(),n.commentById(r.idComment).then(function(t){r.comment=t.data,r.general={title:r.comment.name}},function(t){console.log(t.e)}),r.editComm=function(t,n){e.open({templateUrl:"/comments/commentEdit/commentEdit.view.html",controller:"commentEdit",controllerAs:"vm",resolve:{commentDetails:function(){return{comment:n}}}}).result.then(function(t){void 0!==t&&(r.comment=t)},function(t){console.log("Error im comment View",t)})}}t.$inject=["$routeParams","commentsData","$uibModal","authentication"],angular.module("comments").controller("commentsViewCtrl",t)}(),function(){function t(n,t,e){var o=this;o.commentDetails=t,o.modalWindow={onclose:function(){n.close()},onsubmit:function(t){n.close(t)}},o.sendData=function(){return o.error="",o.editData.commentContent?(o.editComment(t.comment._id,o.editData.commentContent),!1):!(o.error="Input required!")},o.editComment=function(t,n){e.editCommentById(t,{comment:n}).then(function(t){o.modalWindow.onsubmit(t.data)},function(t){o.error="Error!"})}}t.$inject=["$uibModalInstance","commentDetails","commentsData"],angular.module("comments").controller("commentEdit",t)}(),function(){function t(t,n,e,o,r){var i=this;i.logedin=n.logedin(),i.landing="/"!=o.path(),i.deleteById=function(t){e.deleteById(t).then(function(t){o.path("/")},function(t){i.error="Error!"})}}t.$inject=["$scope","authentication","commentsData","$location","$route"],angular.module("comments").controller("commentDirCtrl",t)}(),function(){var t=function(t){return{restrict:"EA",scope:{commentdirective:"=onecomment",onclick:"&onclickf"},templateUrl:"/all/directives/comment/comment.view.html",controller:"commentDirCtrl",controllerAs:"commdirvm"}};t.$inject=["$uibModal"],angular.module("comments").directive("comment",t)}(),angular.module("comments").directive("footos",function(){return{restrict:"EA",templateUrl:"/all/directives/footer/footer.template.html"}}),function(){function t(t,n,e){this.currLocation=t.path(),this.logedin=n.logedin(),this.currUser=n.currUser(),this.logout=function(){n.logout(),t.path("/"),e.reload()}}t.$inject=["$location","authentication","$route"],angular.module("comments").controller("navigaCtrl",t)}(),angular.module("comments").directive("naviga",function(){return{restrict:"EA",templateUrl:"/all/directives/nav/nav.template.html",controller:"navigaCtrl",controllerAs:"navigavm"}});